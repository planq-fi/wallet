(self.webpackJsonp=self.webpackJsonp||[]).push([[16],{2695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(0),r=n(660),o=n(79),a=n(14),c=n(11),i=n(137),p=n(95),u=n(33),T=n(25),d=n(9),l=n(16),S=n(8),y=n(19),x=n(663),f=n(444),E=n(2735),R=n(4);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=(0,o.withRouter)((0,p.withProtectTxProvider)((function({location:e}){const[t,n]=(0,s.useReducer)(E.sendAssetsReducer,E.initialState),{state:{enabled:o,protectTxShow:p,isPTXFree:C},setProtectTxTimeoutFunction:O}=(0,s.useContext)(i.ProtectTxContext),b=(0,T.useSelector)(T.getStoreAccounts),{assets:_}=(0,u.useAssets)(),{networks:A,getNetworkById:P}=(0,u.useNetworks)(),{isFeatureActive:N}=(0,u.useFeatureFlags)(),m=(0,r.parse)(e.search),w=c.SUPPORTED_TRANSACTION_QUERY_PARAMS.reduce((e,t)=>g(g({},e),{},{[t]:(0,S.getParam)(m,t)}),{});(0,s.useEffect)(()=>{const s=(0,f.parseQueryParams)((0,r.parse)(e.search))(A,_,b);s&&s.queryType!==t.txQueryType&&[l.TxQueryTypes.SPEEDUP,l.TxQueryTypes.CANCEL].includes(s.queryType)&&(s.txConfig&&!(0,y.isEmpty)(s.txConfig)?n({type:E.sendAssetsReducer.actionTypes.SET_TXCONFIG,payload:{txConfig:s.txConfig,txQueryType:s.queryType}}):console.debug("[PrefilledTxs]: Error - Missing params. Requires gasPrice, gasLimit, to, data, nonce, from, value, and chainId"))},[w]);const D=[{label:"Send Assets",component:x.SendAssetsFormWithProtectTx,props:(({txConfig:e})=>({txConfig:e}))(t),actions:(e,t)=>{o&&!C&&(e.nonceField=(parseInt(e.nonceField,10)+1).toString()),n({type:E.sendAssetsReducer.actionTypes.FORM_SUBMIT,payload:{form:e,assets:_}}),t()}},{label:(0,d.translateRaw)("CONFIRM_TX_MODAL_TITLE"),component:x.ConfirmTransactionWithProtectTx,props:(({txConfig:e})=>({txConfig:e}))(t),actions:(e,t)=>t()},{label:"",component:x.SignTransactionWithProtectTx,props:(({txConfig:e})=>({txConfig:e}))(t),actions:e=>{n({type:E.sendAssetsReducer.actionTypes.WEB3_SIGN_SUCCESS,payload:e})}},{label:(0,d.translateRaw)("TRANSACTION_BROADCASTED"),component:a.TxReceiptWithProtectTx,props:(({txConfig:e,txReceipt:t})=>({txConfig:e,txReceipt:t}))(t)}],h=[{label:"Send Assets",component:x.SendAssetsFormWithProtectTx,props:(({txConfig:e})=>({txConfig:e}))(t),actions:(e,t)=>{o&&!C&&(e.nonceField=(parseInt(e.nonceField,10)+1).toString()),n({type:E.sendAssetsReducer.actionTypes.FORM_SUBMIT,payload:{form:e,assets:_}}),t()}},{label:"",component:x.SignTransactionWithProtectTx,props:(({txConfig:e})=>({txConfig:e}))(t),actions:(e,t)=>{n({type:E.sendAssetsReducer.actionTypes.SIGN_SUCCESS,payload:{signedTx:e,assets:_,networks:A,accounts:b}}),t()}},{label:(0,d.translateRaw)("CONFIRM_TX_MODAL_TITLE"),component:x.ConfirmTransactionWithProtectTx,props:(({txConfig:e,signedTx:t,error:n})=>({txConfig:e,signedTx:t,error:n}))(t),actions:e=>{O?O(()=>n({type:E.sendAssetsReducer.actionTypes.REQUEST_SEND,payload:e})):n({type:E.sendAssetsReducer.actionTypes.REQUEST_SEND,payload:e})}},{label:(0,d.translateRaw)("TRANSACTION_BROADCASTED"),component:a.TxReceiptWithProtectTx,props:(({txConfig:e,txReceipt:t,txQueryType:n})=>({txConfig:e,txReceipt:t,txQueryType:n}))(t)}],{addTxToAccount:I}=(0,u.useAccounts)();return(0,s.useEffect)(()=>{t.txReceipt&&I(t.txConfig.senderAccount,t.txReceipt)},[t.txReceipt]),(0,s.useEffect)(()=>{if(t.send&&t.signedTx&&!(0,S.isWeb3Wallet)(t.txConfig.senderAccount.wallet)){const{txConfig:e,signedTx:s}=t;new u.ProviderHandler(P(e.networkId)).sendRawTx(s).then(e=>n({type:E.sendAssetsReducer.actionTypes.SEND_SUCCESS,payload:e})).catch(e=>{var t;return n({type:E.sendAssetsReducer.actionTypes.SEND_ERROR,payload:null!=(t=null==e?void 0:e.reason)?t:null==e?void 0:e.message})})}},[t.send]),(0,R.jsx)(a.GeneralStepper,{steps:(()=>{const{senderAccount:e}=t.txConfig,n=e&&(0,S.isWeb3Wallet)(e.wallet)?D:h;return t.txQueryType&&[l.TxQueryTypes.CANCEL,l.TxQueryTypes.SPEEDUP].includes(t.txQueryType)?n.slice(1,n.length):n})(),txNumber:t.txNumber,defaultBackPath:c.ROUTE_PATHS.DASHBOARD.path,defaultBackPathLabel:(0,d.translateRaw)("DASHBOARD"),completeBtnText:(0,d.translateRaw)("SEND_ASSETS_SEND_ANOTHER"),wrapperClassName:"send-assets-stepper "+(p?"has-side-panel":""),basic:N("PROTECT_TX"),onRender:e=>{(0,s.useEffect)(()=>{t.txReceipt&&e()},[t.txReceipt])}})})));t.default=b},2735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAssetsReducer=t.initialState=void 0;var s=n(2),r=n(95),o=n(442),a=n(16),c=n(444);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const T={txConfig:{},txNumber:0};t.initialState=T;const d=(e,t)=>{switch(t.type){case d.actionTypes.FORM_SUBMIT:{const{form:n,assets:s}=t.payload,r=(0,c.processFormDataToTx)(n),a=(0,o.getBaseAssetByNetwork)({network:n.network,assets:s}),i={rawTransaction:r,amount:n.amount,senderAccount:n.account,receiverAddress:n.address.value,networkId:n.network.id,asset:n.asset,baseAsset:null!=a?a:{},from:n.account.address};return p(p({},e),{},{txConfig:i,error:void 0})}case d.actionTypes.SET_TXCONFIG:{const{txConfig:n,txQueryType:s}=t.payload;return{txQueryType:s,txConfig:n,txNumber:e.txNumber+1}}case d.actionTypes.SIGN_SUCCESS:{var n;const{assets:o,networks:a,accounts:c}=t.payload,i=(0,s.hexlify)(t.payload.signedTx),u=(0,r.makeTxConfigFromSignedTx)(t.payload.signedTx,o,a,c,null==(n=e.txConfig)?void 0:n.networkId);return p(p({},e),{},{txConfig:u,signedTx:i})}case d.actionTypes.WEB3_SIGN_SUCCESS:{const n=l(e,t.payload);return p(p({},e),{},{txReceipt:n})}case d.actionTypes.REQUEST_SEND:return p(p({},e),{},{send:!0});case d.actionTypes.SEND_SUCCESS:{const n=l(e,t.payload.hash);return p(p({},e),{},{send:!1,txReceipt:n,error:void 0})}case d.actionTypes.SEND_ERROR:return p(p({},e),{},{send:!1,error:t.payload});case d.actionTypes.RESET:return T;default:return e}};t.sendAssetsReducer=d,d.actionTypes={FORM_SUBMIT:"FORM_SUBMIT",SIGN_SUCCESS:"SIGN_SUCCESS",WEB3_SIGN_SUCCESS:"WEB3_SIGN_SUCCESS",REQUEST_SEND:"REQUEST_SEND",SEND_SUCCESS:"SEND_SUCCESS",RESET:"RESET",SET_TXCONFIG:"SET_TXCONFIG",SEND_ERROR:"SEND_ERROR"};const l=(e,t)=>(0,r.makePendingTxReceipt)(t)(a.ITxType.STANDARD,e.txConfig)}}]);
//# sourceMappingURL=SendAssets.37028b595a45aff2d0a5.js.map