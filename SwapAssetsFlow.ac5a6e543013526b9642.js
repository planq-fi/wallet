(self.webpackJsonp=self.webpackJsonp||[]).push([[19],{2701:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(0),n=o(79),a=o(14),s=o(11),i=o(95),u=o(445),c=o(89),l=o(83),m=o(9),A=o(16),f=o(8),p=o(2752),d=o(2758),g=o(4);function O(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function S(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?O(Object(o),!0).forEach((function(e){T(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function T(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var b=(0,n.withRouter)(t=>{const e=(0,l.useSelector)((0,c.getDefaultAccount)()),{setNetwork:o,handleFromAssetSelected:n,handleToAssetSelected:O,calculateNewFromAmount:T,calculateNewToAmount:b,handleFromAmountChanged:w,handleToAmountChanged:x,handleAccountSelected:y,handleGasLimitEstimation:E,handleRefreshQuote:h,handleFlipAssets:C,handleSwapMax:j,formState:R}=(0,f.useStateReducer)(d.SwapFormFactory,S(S({},d.swapFormInitialState),{},{account:e})),{assets:_,account:P,fromAsset:v,toAsset:k,fromAmount:F,toAmount:N,isCalculatingFromAmount:D,isCalculatingToAmount:M,fromAmountError:I,toAmountError:B,lastChangedAmount:L,exchangeRate:U,approvalGasLimit:G,tradeGasLimit:W,gasPrice:H,expiration:X,approvalTx:$,isEstimatingGas:Q,tradeTx:V,selectedNetwork:Y,gas:J}=R,[Z,q]=(0,r.useState)({}),{state:z,initWith:K,prepareTx:tt,sendTx:et,reset:ot,stopYield:rt}=(0,u.useTxMulti)(),{canYield:nt,isSubmitting:at,transactions:st,error:it}=z,ut=[{title:(0,m.translateRaw)("SWAP"),backBtnText:(0,m.translateRaw)("DASHBOARD"),component:p.SwapAssets,props:{fromAmount:F,toAmount:N,fromAsset:v,toAsset:k,assets:_,isCalculatingFromAmount:D,isCalculatingToAmount:M,fromAmountError:I,toAmountError:B,txError:it,exchangeRate:U,account:P,approvalGasLimit:G,tradeGasLimit:W,gasPrice:H,expiration:X,approvalTx:$,isEstimatingGas:Q,isSubmitting:at,selectedNetwork:Y,gas:J},actions:{handleFromAssetSelected:n,handleToAssetSelected:O,calculateNewFromAmount:T,calculateNewToAmount:b,handleFromAmountChanged:w,handleToAmountChanged:x,handleAccountSelected:y,handleGasLimitEstimation:E,handleRefreshQuote:h,handleFlipAssets:C,handleSwapMax:j,setNetwork:o,onSuccess:()=>{const t={fromAsset:v,toAsset:k,fromAmount:(0,f.bigify)(F),toAmount:(0,f.bigify)(N),rate:(0,f.bigify)(U),lastChangedAmount:L};K(()=>Promise.resolve(($?[$,V]:[V]).map((0,i.appendSender)(P.address))),P,P.network),q(t)}}},...st.flatMap((t,e)=>{var o;return[{title:(0,m.translateRaw)("SWAP_CONFIRM_TITLE"),backBtnText:(0,m.translateRaw)("SWAP"),component:st.length>1?p.ConfirmSwapMultiTx:p.ConfirmSwap,props:{flowConfig:Z,account:P,isSubmitting:at,transactions:st,currentTxIdx:e,error:null!=(o=null==it?void 0:it.reason)?o:null==it?void 0:it.message},actions:{onComplete:()=>{tt(t.txRaw)}}},{title:"",backBtnText:(0,m.translateRaw)("SWAP_CONFIRM_TITLE"),component:P&&a.WALLET_STEPS[P.wallet],props:{network:P&&P.network,senderAccount:P,rawTransaction:t.txRaw},actions:{onSuccess:t=>et(t)}}]}),{title:(0,m.translateRaw)("TRANSACTION_BROADCASTED"),backBtnText:(0,m.translateRaw)("DEP_SIGNTX"),component:p.SwapTransactionReceipt,props:{assetPair:Z,account:P,transactions:st,onSuccess:()=>{ot(),lt(0)}}}],[ct,lt]=(0,r.useState)(0),mt=ut[ct],At=mt.component;return(0,r.useEffect)(()=>{nt&&(1===st.length&&st[0].status===A.ITxStatus.PREPARING?tt(st[0].txRaw):lt(ct+1),rt())},[nt]),(0,g.jsx)(a.ExtendedContentPanel,{onBack:()=>{const{history:e}=t;0===ct?e.push(s.ROUTE_PATHS.DASHBOARD.path):lt(ct-1)},stepper:{current:ct+1,total:ut.length},width:"650px",heading:mt.title,description:mt.description,backBtnText:mt.backBtnText,children:(0,g.jsx)(At,S(S({},mt.props),mt.actions),`${mt.title}${ct}`)})});e.default=b},2723:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.stepsContent=void 0;var r=s(o(657)),n=s(o(659)),a=o(9);function s(t){return t&&t.__esModule?t:{default:t}}const i=[{title:(0,a.translateRaw)("APPROVE_SWAP"),icon:n.default},{title:(0,a.translateRaw)("COMPLETE_SWAP"),icon:r.default}];e.stepsContent=i},2752:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"SwapAssets",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"ConfirmSwap",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"SwapTransactionReceipt",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"ConfirmSwapMultiTx",{enumerable:!0,get:function(){return s.default}});var r=i(o(2753)),n=i(o(2755)),a=i(o(2756)),s=i(o(2757));function i(t){return t&&t.__esModule?t:{default:t}}},2753:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(0),n=f(o(447)),a=f(o(6)),s=o(14),i=(o(11),o(448)),u=o(25),c=(o(7),function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var o=A(e);if(o&&o.has(t))return o.get(t);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=n?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=t[a]}r.default=t,o&&o.set(t,r)}(o(9)),o(8)),l=o(2693),m=(o(2754),o(4));function A(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,o=new WeakMap;return(A=function(t){return t?o:e})(t)}function f(t){return t&&t.__esModule?t:{default:t}}(0,a.default)(s.Button).withConfig({displayName:"SwapAssets__StyledButton",componentId:"obpmim-0"})(["margin-top:12px;width:100%;&& div{justify-content:center;}"]);var p=t=>{const{selectedNetwork:e,account:o,fromAmount:a,toAmount:A,fromAsset:f,toAsset:p,assets:d,isCalculatingFromAmount:g,isCalculatingToAmount:O,fromAmountError:S,toAmountError:T,txError:b,onSuccess:w,isSubmitting:x,handleFromAssetSelected:y,handleToAssetSelected:E,calculateNewFromAmount:h,calculateNewToAmount:C,handleFromAmountChanged:j,handleToAmountChanged:R,handleAccountSelected:_,handleGasLimitEstimation:P,handleRefreshQuote:v,handleFlipAssets:k,handleSwapMax:F,approvalTx:N,exchangeRate:D,approvalGasLimit:M,tradeGasLimit:I,gasPrice:B,isEstimatingGas:L,expiration:U,setNetwork:G,gas:W}=t,H=((0,u.useSelector)(u.getSettings),(0,u.useSelector)(u.getIsDemoMode),(0,u.useSelector)((0,u.selectNetwork)(e))),X=(0,u.useSelector)((0,u.getBaseAssetByNetwork)(H)),[$,Q]=(0,r.useState)(!1),V=(0,u.useSelector)(u.getStoreAccounts),{getAssetRate:Y}=(0,i.useRates)(),J=(0,u.useSelector)(u.getUserAssets),Z=Y(X),q=(f&&Y(f),(0,l.getUnselectedAssets)(d,f,p)),z=(q.filter(t=>J.find(e=>t.uuid===e.uuid)),(0,r.useCallback)((0,n.default)(C,500),[o,f,p]),(0,r.useCallback)((0,n.default)(h,500),[o,f,p]),(0,l.getEstimatedGasFee)({tradeGasLimit:I,approvalGasLimit:M,baseAssetRate:Z,gas:W})),K=f?(0,l.getAccountsWithAssetBalance)(V,f,a,X.uuid,z):[];(0,r.useEffect)(()=>{const t=(0,c.sortByLabel)(K)[0];t&&(o&&o.uuid!==t.uuid||!o)&&_(t)},[JSON.stringify(K)]),(0,r.useEffect)(()=>{a&&f&&o&&!K.find(t=>t.uuid===o.uuid)&&_(void 0)},[f,a,B,I,M]),(0,r.useEffect)(()=>{v()},[o,p]),(0,r.useEffect)(()=>{P()},[N,o]),(0,c.useInterval)(()=>{if(!U)return;const t=(0,c.getTimeDifference)(U)>=0;t!==$&&Q(t)},1e3,!1,[U]);return(0,m.jsx)(s.Box,{mt:"20px",mb:"1em",children:"Coming soon"})};e.default=p},2754:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwapQuote=void 0;var r=o(14),n=o(134),a=o(7),s=o(9),i=o(8),u=o(4);e.SwapQuote=({exchangeRate:t,fromAsset:e,fromAssetRate:o,toAsset:c,fromAmount:l,toAmount:m,baseAsset:A,baseAssetRate:f,estimatedGasFee:p,isExpired:d,expiration:g,settings:O,handleRefreshQuote:S})=>(0,u.jsxs)(r.Box,{border:"1px solid #55b6e2",p:"3",children:[(0,u.jsxs)(r.Box,{variant:"rowAlign",justifyContent:"space-between",mb:"3",children:[(0,u.jsx)(r.Heading,{m:"0",fontWeight:"bold",children:(0,s.translateRaw)("YOUR_QUOTE")}),(0,u.jsx)(r.LinkApp,{href:"#",variant:"opacityLink",children:(0,u.jsxs)(r.Box,{variant:"rowAlign",onClick:()=>S(),children:[(0,u.jsx)(r.Icon,{type:"refresh",width:"16px",color:"BLUE_BRIGHT"}),(0,u.jsx)(r.Text,{ml:a.SPACING.XS,mb:0,children:(0,s.translateRaw)("GET_NEW_QUOTE")})]})})]}),(0,u.jsxs)(r.Box,{variant:"rowAlign",justifyContent:"space-between",mb:"3",children:[(0,u.jsxs)(r.Box,{children:[(0,s.translateRaw)("Amount")," ",(0,u.jsx)(r.Tooltip,{tooltip:(0,s.translateRaw)("SWAP_AMOUNT_TOOLTIP")})]}),(0,u.jsx)(r.Amount,{style:{textDecoration:d?"line-through":"none"},text:`${(0,i.bigify)(l).toFixed(6)} ${e.ticker} = ${(0,i.bigify)(m).toFixed(6)} ${c.ticker}`,fiat:{symbol:(0,n.getFiat)(O).symbol,ticker:(0,n.getFiat)(O).ticker,amount:(0,i.convertToFiat)(l,o).toFixed(2)}})]}),(0,u.jsxs)(r.Box,{variant:"rowAlign",justifyContent:"space-between",mb:"3",children:[(0,u.jsxs)(r.Box,{children:[(0,s.translateRaw)("SWAP_RATE_LABEL")," ",(0,u.jsx)(r.Tooltip,{tooltip:(0,s.translateRaw)("SWAP_RATE_TOOLTIP")})]}),(0,u.jsx)(r.Amount,{style:{textDecoration:d?"line-through":"none"},text:`1 ${e.ticker} = ${(0,i.bigify)(t).toFixed(6)} ${c.ticker}`,fiat:{symbol:(0,n.getFiat)(O).symbol,ticker:(0,n.getFiat)(O).ticker,amount:(0,i.convertToFiat)((0,i.bigify)(1),o).toFixed(2)}})]}),(0,u.jsxs)(r.Box,{variant:"rowAlign",justifyContent:"space-between",mb:"3",children:[(0,u.jsxs)(r.Box,{children:[(0,s.translateRaw)("ESTIMATED_COST")," ",(0,u.jsx)(r.Tooltip,{tooltip:(0,s.translateRaw)("SWAP_TX_FEE_TOOLTIP")})]}),(0,u.jsx)(r.Amount,{style:{textDecoration:d?"line-through":"none"},asset:{amount:p,ticker:A.ticker},fiat:{symbol:(0,n.getFiat)(O).symbol,ticker:(0,n.getFiat)(O).ticker,amount:(0,i.convertToFiat)(p,f).toFixed(2)}})]}),(0,u.jsxs)(r.Box,{variant:"rowAlign",justifyContent:"space-between",children:[(0,u.jsxs)(r.Box,{children:[(0,s.translateRaw)("EXPIRES_IN")," ",(0,u.jsx)(r.Tooltip,{tooltip:(0,s.translateRaw)("SWAP_EXPIRY_TOOLTIP")})]}),(0,u.jsx)(r.Box,{children:d?(0,u.jsx)(r.Body,{m:"0",color:"ERROR_RED",textTransform:"uppercase",children:(0,s.translateRaw)("EXPIRED")}):(0,u.jsx)(r.TimeCountdown,{value:g})})]})]})},2755:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({flowConfig:t,account:e,transactions:o,currentTxIdx:u,onComplete:c,error:l}){const{fromAsset:m,toAsset:A,fromAmount:f,toAmount:p}=t,d=(0,n.useSelector)(n.getAccountsAssets),g=o.map(t=>(0,s.makeSwapTxConfig)(d)(t.txRaw,e,m,f.toString()))[u];return(0,i.jsx)(r.ConfirmTransaction,{resetFlow:()=>c&&c(),onComplete:()=>c&&c(),error:l,txConfig:g,txType:a.ITxType.SWAP,customComponent:()=>(0,i.jsx)(r.SwapFromToDiagram,{fromSymbol:m.ticker,toSymbol:A.ticker,fromUUID:m.uuid,toUUID:A.uuid,fromAmount:f.toString(),toAmount:p.toString()})})};var r=o(14),n=o(25),a=o(16),s=o(2693),i=o(4)},2756:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){let{assetPair:e,transactions:o,account:r,onSuccess:T}=t,b=function(t,e){if(null==t)return{};var o,r,n=function(t,e){if(null==t)return{};var o,r,n={},a=Object.keys(t);for(r=0;r<a.length;r++)o=a[r],e.indexOf(o)>=0||(n[o]=t[o]);return n}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)o=a[r],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}(t,g);const{getAssetByUUID:w,assets:x}=(0,c.useAssets)(),{settings:y}=(0,c.useSettings)(),{getAssetRate:E}=(0,c.useRates)(),{getNetworkById:h}=(0,c.useNetworks)(),C=(0,n.default)(["fromAsset","toAsset","fromAmount","toAmount"],e),j=(0,l.useSelector)(l.getAccountsAssets),R=o.map((t,n)=>{const a=n===o.length-1?A.ITxType.SWAP:A.ITxType.APPROVAL,s=a===A.ITxType.SWAP?(0,p.makeSwapTxConfig)(j)(t.txRaw,r,e.fromAsset,e.fromAmount.toString()):(0,u.makeTxConfigFromTx)(t.txRaw,x,r.network,[r]);return(0,u.makeTxItem)(a,s,t.txHash,t.txReceipt)}),_=R.map(({txReceipt:t})=>t),P=h(R[0].txConfig.networkId),v=w(P.baseAsset),k=E(v),F=(0,i.getFiat)(y),N=()=>(0,d.jsx)(s.SwapFromToDiagram,{fromSymbol:C.fromAsset.ticker,toSymbol:C.toAsset.ticker,fromAmount:C.fromAmount.toString(),toAmount:C.toAmount.toString(),fromUUID:C.fromAsset.uuid,toUUID:C.toAsset.uuid});return 1===_.length?(0,d.jsx)(a.TxReceipt,function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?O(Object(o),!0).forEach((function(e){S(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({disableDynamicTxReceiptDisplay:!0,txReceipt:R[0].txReceipt,txConfig:R[0].txConfig,completeButton:(0,m.translateRaw)("SWAP_START_ANOTHER"),resetFlow:T,onComplete:T,customComponent:N},b)):(0,d.jsx)(a.MultiTxReceipt,{txType:A.ITxType.SWAP,transactions:o,transactionsConfigs:R.map(({txConfig:t})=>t),steps:f.stepsContent,account:r,network:r.network,completeButtonText:(0,m.translateRaw)("SWAP_START_ANOTHER"),resetFlow:T,onComplete:T,customComponent:N,fiat:F,baseAssetRate:k})};var r,n=(r=o(664))&&r.__esModule?r:{default:r},a=o(658),s=o(226),i=o(134),u=o(95),c=o(33),l=o(25),m=o(9),A=o(16),f=o(2723),p=o(2693),d=o(4);const g=["assetPair","transactions","account","onSuccess"];function O(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function S(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}},2757:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({flowConfig:t,currentTxIdx:e,transactions:o,onComplete:r,error:m}){const{fromAsset:f,toAsset:p,fromAmount:d,toAmount:g}=t,O=o.map(t=>(0,n.default)(["status"],t)),S=O.findIndex(t=>t===u.ITxStatus.BROADCASTED),T=A(A({},c.stepsContent[0]),{},{content:(0,i.translateRaw)("SWAP_STEP1_TEXT",{$token:f.ticker}),buttonText:""+(0,i.translateRaw)("APPROVE_SWAP"),loading:O[0]===u.ITxStatus.BROADCASTED,onClick:r}),b=A(A({},c.stepsContent[1]),{},{content:(0,i.translateRaw)("SWAP_STEP2_TEXT"),buttonText:""+(0,i.translateRaw)("CONFIRM_TRANSACTION"),loading:O[1]===u.ITxStatus.BROADCASTED,onClick:r});return(0,l.jsxs)("div",{children:[(0,l.jsx)(a.Typography,{as:"p",style:{marginBottom:"2em"},children:(0,i.translateRaw)("SWAP_INTRO")}),(0,l.jsx)(s.SwapFromToDiagram,{fromSymbol:f.ticker,toSymbol:p.ticker,fromUUID:f.uuid,toUUID:p.uuid,fromAmount:d.toString(),toAmount:g.toString()}),(0,l.jsx)(a.VerticalStepper,{currentStep:-1===S?e:S,steps:[T,b],error:void 0!==m})]})};var r,n=(r=o(331))&&r.__esModule?r:{default:r},a=o(14),s=o(226),i=o(9),u=o(16),c=o(2723),l=o(4);function m(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function A(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?m(Object(o),!0).forEach((function(e){f(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):m(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function f(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}},2758:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwapFormFactory=e.swapFormInitialState=void 0;var r=o(0),n=o(136),a=S(o(219)),s=o(11),i=o(95),u=o(105),c=o(279),l=o(667),m=o(25),A=S(o(9)),f=o(8),p=o(2759);const d=["price","sellAmount"],g=["price","buyAmount"],O=["txType"];function S(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(null==t)return{};var o,r,n=function(t,e){if(null==t)return{};var o,r,n={},a=Object.keys(t);for(r=0;r<a.length;r++)o=a[r],e.indexOf(o)>=0||(n[o]=t[o]);return n}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)o=a[r],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}function b(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function w(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?b(Object(o),!0).forEach((function(e){x(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):b(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function x(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const y={selectedNetwork:"Ethereum",account:void 0,fromAsset:void 0,fromAmount:"",fromAmountError:void 0,isCalculatingFromAmount:!1,toAsset:void 0,toAmount:"",toAmountError:void 0,isCalculatingToAmount:!1,lastChangedAmount:p.LAST_CHANGED_AMOUNT.FROM};e.swapFormInitialState=y;e.SwapFormFactory=({state:t,setState:e})=>{const o=(0,m.useSelector)((0,m.selectNetwork)(t.selectedNetwork)),S=(0,m.useSelector)((0,m.getBaseAssetByNetwork)(o)),b=(0,m.useSelector)((0,m.getSwapAssetsByNetwork)(t.selectedNetwork)),x=b.sort((t,e)=>t.ticker.localeCompare(e.ticker));(0,r.useEffect)(()=>{e(t=>w(w({},t),{},{fromAsset:S,toAsset:x.filter(t=>t.uuid!==S.uuid)[0]}))},[b.length,o]);const y=async r=>{const{fromAsset:n,toAsset:i,isCalculatingFromAmount:c,account:l}=t;if(n&&i&&!c)if(0!==r.length)if((0,f.bigify)(r).lte(0))e(t=>w(w({},t),{},{isCalculatingFromAmount:!1,toAmountError:(0,A.default)("SWAP_ZERO_VALUE")}));else try{e(t=>w(w({},t),{},{isCalculatingFromAmount:!0}));const t=await u.DexService.instance.getOrderDetailsTo(o,l,n,i,r),{price:a,sellAmount:c}=t,m=T(t,d);e(t=>w(w({},t),{},{isCalculatingFromAmount:!1,fromAmount:c.toString(),fromAmountError:"",toAmountError:"",exchangeRate:(0,f.withCommission)({amount:(0,f.divideBNFloats)(1,a),rate:s.MYC_DEX_COMMISSION_RATE}).toString()},m))}catch(t){if(a.default.isCancel(t))return;console.error(t),e(e=>{var o,r;return w(w({},e),{},{isCalculatingFromAmount:!1,fromAmount:"",toAmountError:null!=(o=t.response)&&null!=(r=o.data)&&r.code&&109===t.response.data.code?(0,A.default)("SWAP_INSUFFICIENT_FUNDS"):(0,A.default)("UNEXPECTED_ERROR",{$link:(0,f.formatErrorEmailMarkdown)("Swap Error",t)})})})}else e(t=>w(w({},t),{},{toAmount:"",fromAmount:""}))},E=async r=>{const{fromAsset:n,toAsset:i,isCalculatingToAmount:c,account:l}=t;if(n&&i&&!c)if(0!==r.length)if((0,f.bigify)(r).lte(0))e(t=>w(w({},t),{},{isCalculatingToAmount:!1,fromAmountError:(0,A.default)("SWAP_ZERO_VALUE")}));else try{e(t=>w(w({},t),{},{isCalculatingToAmount:!0,lastChangedAmount:p.LAST_CHANGED_AMOUNT.FROM}));const t=await u.DexService.instance.getOrderDetailsFrom(o,l,n,i,r),{price:a,buyAmount:c}=t,m=T(t,g);e(t=>w(w({},t),{},{isCalculatingToAmount:!1,toAmount:c.toString(),fromAmountError:"",toAmountError:"",exchangeRate:(0,f.withCommission)({amount:(0,f.multiplyBNFloats)(1,a),rate:s.MYC_DEX_COMMISSION_RATE}).toString()},m))}catch(t){if(a.default.isCancel(t))return;console.error(t),e(e=>{var o,r;return w(w({},e),{},{isCalculatingToAmount:!1,toAmount:"",fromAmountError:null!=(o=t.response)&&null!=(r=o.data)&&r.code&&109===t.response.data.code?t.response.data.reason:(0,A.default)("UNEXPECTED_ERROR",{$link:(0,f.formatErrorEmailMarkdown)("Swap Error",t)})})})}else e(t=>w(w({},t),{},{toAmount:"",fromAmount:""}))};return{setNetwork:t=>{e(e=>w(w({},e),{},{selectedNetwork:t,fromAmount:"",fromAmountError:"",toAmount:"",toAmountError:""}))},handleFromAssetSelected:o=>{const{isCalculatingFromAmount:r,isCalculatingToAmount:n}=t;r||n||e(t=>w(w({},t),{},{fromAsset:o,fromAmount:"",fromAmountError:"",toAmount:"",toAmountError:""}))},handleToAssetSelected:t=>{e(e=>w(w({},e),{},{toAsset:t}))},calculateNewFromAmount:y,calculateNewToAmount:E,handleFromAmountChanged:t=>{e(e=>w(w({},e),{},{fromAmount:t,lastChangedAmount:p.LAST_CHANGED_AMOUNT.FROM,fromAmountError:"",toAmountError:""}))},handleToAmountChanged:t=>{e(e=>w(w({},e),{},{toAmount:t,lastChangedAmount:p.LAST_CHANGED_AMOUNT.TO,fromAmountError:"",toAmountError:""}))},handleAccountSelected:t=>{e(e=>w(w({},e),{},{account:t}))},handleGasLimitEstimation:async()=>{const{approvalTx:r,account:n}=t;if(r&&n){e(t=>w(w({},t),{},{isEstimatingGas:!0}));try{const t=r&&await(0,i.checkRequiresApproval)(o,r.to,n.address,r.data),{txType:a}=r,s=T(r,O),u=(0,f.inputGasLimitToHex)(t?await(0,c.getGasEstimate)(o,s):"0");e(t=>w(w({},t),{},{isEstimatingGas:!1,approvalGasLimit:u}))}catch(t){console.error(t),e(e=>w(w({},e),{},{isEstimatingGas:!1,fromAmountError:(0,A.default)("UNEXPECTED_ERROR",{$link:(0,f.formatErrorEmailMarkdown)("Swap Error",t)})}))}}},handleRefreshQuote:()=>{const{fromAmount:e,toAmount:o,lastChangedAmount:r}=t;r===p.LAST_CHANGED_AMOUNT.FROM?E(e):y(o)},handleFlipAssets:()=>{e(t=>w(w({},t),{},{fromAsset:t.toAsset,toAsset:t.fromAsset,fromAmount:t.toAmount,toAmount:t.fromAmount,fromAmountError:"",toAmountError:"",lastChangedAmount:t.lastChangedAmount===p.LAST_CHANGED_AMOUNT.FROM?p.LAST_CHANGED_AMOUNT.TO:p.LAST_CHANGED_AMOUNT.FROM}))},handleSwapMax:async()=>{var o;const r=t.fromAsset,a=(0,l.getAccountBalance)(t.account,r),i=(0,n.formatUnits)(a,null!=(o=r.decimal)?o:s.DEFAULT_ASSET_DECIMAL);e(t=>w(w({},t),{},{fromAmount:i,fromAmountError:"",toAmountError:"",lastChangedAmount:p.LAST_CHANGED_AMOUNT.FROM})),await E(i)},formState:w(w({},t),{},{assets:x})}}},2759:function(t,e,o){"use strict";let r;Object.defineProperty(e,"__esModule",{value:!0}),e.LAST_CHANGED_AMOUNT=void 0,e.LAST_CHANGED_AMOUNT=r,function(t){t.FROM="FROM_AMOUNT",t.TO="TO_AMOUNT"}(r||(e.LAST_CHANGED_AMOUNT=r={}))}}]);
//# sourceMappingURL=SwapAssetsFlow.ac5a6e543013526b9642.js.map